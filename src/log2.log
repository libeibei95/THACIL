nohup: 忽略输入
2021-06-07 07:41:00.476956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:Deprecation warnings have been disabled. Set TF_ENABLE_DEPRECATION_WARNINGS=1 to re-enable them.
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

2021-06-07 07:41:02,341 root  INFO     phase: train
2021-06-07 07:41:02,341 root  INFO     batch_size: 2048
2021-06-07 07:41:02,341 root  INFO     max_epoch: 40
2021-06-07 07:41:02,342 root  INFO     initial_learning_rate: 0.001
2021-06-07 07:41:02,342 root  INFO     reg: 0.00005000
2021-06-07 07:41:02,342 root  INFO     optimizer: adam
2021-06-07 07:41:02,342 root  INFO     dropout: 0.80
2021-06-07 07:41:02,342 root  INFO     data_dir: ../data/input
2021-06-07 07:41:02,342 root  INFO     out_dir: ../data/output2/THACIL
2021-06-07 07:41:02,342 root  INFO     optimizer: adam
2021-06-07 07:41:02,342 root  INFO     restore_model_dir: ../data/input
2021-06-07 07:41:02,342 root  INFO     neg_ratio: 1.0
2021-06-07 07:41:02,342 root  INFO     max_length: 160
2021-06-07 07:41:02,342 root  INFO     user_dim: 128
2021-06-07 07:41:02,342 root  INFO     item_dim: 64
2021-06-07 07:41:02,343 root  INFO     cate_dim: 64
2021-06-07 07:41:02,343 root  INFO     num_heads: 8
2021-06-07 07:41:02,343 root  INFO     fusion_layers: 128
2021-06-07 07:41:02,343 root  INFO     --------------------
WARNING:tensorflow:From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/nets.py:17: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

2021-06-07 07:41:02,347 tensorflow WARNING  From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/nets.py:17: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/nets.py:23: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2021-06-07 07:41:02,352 tensorflow WARNING  From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/nets.py:23: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

WARNING:tensorflow:From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/nets.py:24: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

2021-06-07 07:41:02,352 tensorflow WARNING  From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/nets.py:24: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

WARNING:tensorflow:From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/model.py:314: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2021-06-07 07:41:02,355 tensorflow WARNING  From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/model.py:314: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/model.py:356: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

2021-06-07 07:41:02,361 tensorflow WARNING  From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/model.py:356: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/model.py:44: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2021-06-07 07:41:02,361 tensorflow WARNING  From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/model.py:44: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/model.py:205: The name tf.AUTO_REUSE is deprecated. Please use tf.compat.v1.AUTO_REUSE instead.

2021-06-07 07:41:02,391 tensorflow WARNING  From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/model.py:205: The name tf.AUTO_REUSE is deprecated. Please use tf.compat.v1.AUTO_REUSE instead.

WARNING:tensorflow:From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/model.py:240: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

2021-06-07 07:41:03,163 tensorflow WARNING  From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/model.py:240: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/model.py:76: The name tf.summary.merge is deprecated. Please use tf.compat.v1.summary.merge instead.

2021-06-07 07:41:04,529 tensorflow WARNING  From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/model.py:76: The name tf.summary.merge is deprecated. Please use tf.compat.v1.summary.merge instead.

WARNING:tensorflow:From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/model.py:76: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

2021-06-07 07:41:04,530 tensorflow WARNING  From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/model.py:76: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

WARNING:tensorflow:From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/model.py:82: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2021-06-07 07:41:04,533 tensorflow WARNING  From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/model.py:82: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2021-06-07 07:41:05,090 root  INFO     load train visual feature
2021-06-07 07:41:07,003 root  INFO     load test visual feature
2021-06-07 07:41:09,467 root  INFO     start read data list from disk
2021-06-07 07:41:27,825 root  INFO     generate samples for training
Namespace(batch_size=2048, cate_dim=64, data_dir='../data/input', display=100, dropout=0.8, fusion_layers=[128], initial_lr=0.001, item_dim=64, max_epoch=40, max_gradient_norm=5.0, max_length=160, n_block=8, n_cl_neg=256, neg_flag=2, neg_ratio=1.0, num_heads=8, optimizer='adam', out_dir='../data/output2', phase='train', pos_flag=1, reg=5e-05, restore_model_dir='../data/input', user_dim=128)
2021-06-07 07:41:51,861 root  INFO     3767308 test samples
WARNING:tensorflow:From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/solver.py:71: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

2021-06-07 07:41:51,862 tensorflow WARNING  From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/solver.py:71: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/solver.py:75: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2021-06-07 07:41:51,863 tensorflow WARNING  From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/solver.py:75: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2021-06-07 07:41:51.904514: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2300000000 Hz
2021-06-07 07:41:51.905117: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559883c31c80 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-06-07 07:41:51.905222: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-06-07 07:41:51.910370: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-06-07 07:41:52.022600: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559883ba1fc0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-06-07 07:41:52.022825: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3090, Compute Capability 8.6
2021-06-07 07:41:52.025729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 0 with properties: 
name: GeForce RTX 3090 major: 8 minor: 6 memoryClockRate(GHz): 1.695
pciBusID: 0000:b3:00.0
2021-06-07 07:41:52.025944: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-07 07:41:52.031793: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-07 07:41:52.033549: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-06-07 07:41:52.034157: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-06-07 07:41:52.038174: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2021-06-07 07:41:52.039073: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-06-07 07:41:52.039436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-06-07 07:41:52.042171: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1793] Adding visible gpu devices: 0
2021-06-07 07:41:52.042346: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-06-07 07:41:52.394375: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-06-07 07:41:52.394528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 
2021-06-07 07:41:52.394565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N 
2021-06-07 07:41:52.396845: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13546 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3090, pci bus id: 0000:b3:00.0, compute capability: 8.6)
WARNING:tensorflow:From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/solver.py:41: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2021-06-07 07:41:52,398 tensorflow WARNING  From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/solver.py:41: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2021-06-07 07:42:05,080 root  INFO     load train visual feature into GPU memory successfully
2021-06-07 07:42:05,081 root  INFO     Create model with fresh parameters
WARNING:tensorflow:From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/solver.py:60: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2021-06-07 07:42:05,082 tensorflow WARNING  From /mnt/52547AC5547AAAFD/workspace/libeibei/THACIL/src/solver.py:60: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2021-06-07 07:42:07,265 root  INFO     create summary writer successfully
2021-06-07 07:42:07,266 root  INFO     start train phase
2021-06-07 07:42:07,266 root  INFO     train iterations: 500
2021-06-07 07:42:18.709910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-06-07 07:43:31,049 root  INFO     epoch 1-train step 100: loss: 365.858, acc: 0.606 in 46.407s, load 37.355s
2021-06-07 07:44:37,191 root  INFO     epoch 1-train step 200: loss: 77.558, acc: 0.625 in 33.115s, load 33.007s
2021-06-07 07:45:45,487 root  INFO     epoch 1-train step 300: loss: 52.599, acc: 0.626 in 33.140s, load 35.134s
2021-06-07 07:46:53,772 root  INFO     epoch 1-train step 400: loss: 40.696, acc: 0.629 in 33.065s, load 35.198s
2021-06-07 07:47:59,621 root  INFO     epoch 1-train step 500: loss: 33.888, acc: 0.628 in 32.891s, load 32.938s
2021-06-07 07:48:00,107 root  INFO     Saved model in epoch 1
2021-06-07 07:48:00,108 root  INFO     lr: 0.001, min loss: 114.1199729309082
2021-06-07 07:48:08,244 root  INFO     start train phase
2021-06-07 07:48:08,245 root  INFO     train iterations: 500
2021-06-07 07:49:41,996 root  INFO     epoch 2-train step 100: loss: 29.817, acc: 0.629 in 35.751s, load 57.979s
